<!DOCTYPE html>
<html data-theme="valentine">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="public/style.css">
    <link href="https://cdn.jsdelivr.net/npm/daisyui@4.7.2/dist/full.min.css" rel="stylesheet" type="text/css" />
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="public/main.js"></script>
</head>
<body>
    <main class="container max-w-screen-lg mx-auto min-h-screen flex flex-col">
        {{template "navbar" .}}
        <div class="flex flex-col w-full lg:flex-row flex-grow">
            <div class="flex-grow card bg-base-300 rounded-box overflow-scroll p-3" style="height: calc(100vh - 100px)">
                <p class="text-lg font-bold text-center pb-2">Users</p>
                <ul class="overflow-scroll">
                    {{range .Users}}
                        <li class="py-2 p-4 rounded-lg mb-2 bg-base-100">{{.Name}}</li>
                    {{end}}
                </ul>
            </div> 
            <div class="divider lg:divider-horizontal"></div> 
            <div class="grid flex-grow card bg-base-300 rounded-box p-2 overflow-scroll" style="height: calc(100vh - 100px)">
                <a class="text-lg font-bold text-center">Messages</a>
                {{template "chatroom" .}}
            </div>
        </div>
    </main>

    <script>

        var container = document.getElementById('textchat');
        container.scrollTop = container.scrollHeight;


        let value = localStorage.getItem('theme');
        var htmlElement = document.querySelector('html');
        htmlElement.setAttribute('data-theme', value);

        let nameCookie = getCookie('name');
        let messageField = document.getElementById(nameCookie)
        if(messageField != null){
            messageField.classList.remove('chat-start')
            messageField.classList.add('chat-end')
        }

        if(nameCookie != ''){
            document.getElementById('userform')?.classList.add('hidden')
            document.getElementById('username').innerHTML = nameCookie
        }

        function logout(){
            document.getElementById('userform')?.classList.remove('hidden')
            document.getElementById('username')?.parentElement?.classList.add('hidden')
            removeCookie('name');
            window.location.reload();
        }

        function setTheme(value){
            localStorage.setItem('theme', value);
        }

    </script>
</body>
</html>